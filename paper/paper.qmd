---
title: "My title"
subtitle: "My subtitle if needed"
author: "Faiza Imam"
thanks: "Code and data are available at: []."
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false


library(tidyverse)
library(knitr)
library(tidyverse)
library(usethis)
library(kableExtra)
library (arrow)
library(opendatatoronto)
library(janitor)

library(here)
home_data <- readr::read_csv(here::here("data/analysis_data/clean_dataNA.csv"))


```


# Introduction

You can and should cross-reference sections and sub-sections. We use @citeR and @rohan.

The remainder of this paper is structured as follows. @sec-data....


# Data {#sec-data}

Some of our data is of penguins (@fig-bills), from @palmerpenguins.
```{r}
#| echo: false
#| label: tbl-summ_table
#| tbl-cap: "Summary of clean data"
#| message: false


Sum_data <- home_data %>%
  group_by(Year_of_death, Cause_of_death, Age_group, Gender) %>%
  summarize(total_deaths = sum(death_toll))

# Write the summarized data to a CSV file
write_csv(x = Sum_data, file = "Sum_data.csv")


head(Sum_data, 7) %>%
  kable(col.names = c("Year","Cause of Death", "Age Group", "Gender", "Death Toll"), booktabs = TRUE)


```

Talk more about it.

And also planes (@fig-planes). (You can change the height and width, but don't worry about doing that until you have finished every other aspect of the paper - Quarto will try to make it look nice and the defaults usually work well once you have enough text.)



Talk way more about it. 

```{r}
#| echo: false
#| label: tbl-Gender
#| tbl-cap: "Homelessness gender total death tolls"

#Gender Death Tolls
GendervDeath <- home_data %>%
  group_by(Gender) %>%
  summarize(total_deaths = sum(death_toll))


 write_csv(
  x = GendervDeath ,
  file = "GendervDeath.csv"
)
 
  head (GendervDeath, 7) |>
  kable(
    col.names = c("Gender", "Death Tolls"),
  booktabs = TRUE
  )
  


```

```{r}
#| echo: false
#| label: tbl-Agegroup
#| tbl-cap: "Age Groups and their total death tolls"



#Age group death count
AgevDeath <- home_data %>%
  group_by(Age_group) %>%
  summarize(total_deaths = sum(death_toll))

 write_csv(
  x = AgevDeath ,
  file = "AgevDeath.csv"
)
 
  head (AgevDeath, 7) |>
  kable(
    col.names = c("Age Group", "Death Tolls"),
  booktabs = TRUE
  )
```

# Results

Our results are summarized in @tbl-modelresults.

```{r}
#| echo: false
#| warning: false
#| label: fig-Yearvcuase
#| fig-cap: Cause of death by year


############
#Yearly death causes
YearvCause <- home_data %>%
  group_by(Year_of_death,Cause_of_death) %>%
  summarize(total_deaths = sum(death_toll))

 write_csv(
  x = YearvCause,
  file = "YearvCause.csv"
)

 YearvCause %>%
  ggplot(aes(x = Year_of_death , y = total_deaths, fill = factor(Cause_of_death))) +
  geom_col(position = "dodge", alpha = 0.8) +  # Use geom_col() for bar charts
  labs(title = "Total Cause of death by year", x = "Year", y = "Total Deaths", fill = "Cause of Death") +
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
 


```

```{r}
#| label: fig-AgevCause
#| fig-cap: Total cause of death by age group
#| echo: false
#| message: false

# Define the order of age groups
age_order <- c("<20", "20-39", "40-59", "60+")

# Use factor to set the order of levels for Age_group
home_data$Age_group <- factor(home_data$Age_group, levels = age_order)

# Group by Cause_of_death and Age_group, maintaining the age order
AgevCause <- home_data %>%
  group_by(Cause_of_death, Age_group) %>%
  summarize(total_deaths = sum(death_toll))


 write_csv(
  x = AgevCause,
  file = "AgevCause.csv"
)

 AgevCause %>%
  ggplot(aes(x = Age_group , y = total_deaths, fill = factor(Cause_of_death))) +
  geom_col(position = "dodge", alpha = 0.8) + 
  labs(title = "Total deaths by Age Group", x = "Age Group", y = "Total Deaths", fill = "Cause of deaths") +
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
#| label: fig-Gendercause
#| fig-cap: "Total cause of deaths grouped by gender"
#| echo: false
#| message: false

#Gender and cuases of death within each group
GendervCause <- home_data %>%
  group_by(Cause_of_death, Gender) %>%
  summarize(total_deaths = sum(death_toll))


 write_csv(
  x = GendervCause ,
  file = "GendervCause.csv"
)

GendervCause %>%
  ggplot(aes(x = Cause_of_death, y = total_deaths, fill = factor(Gender))) +
  geom_col(position = "dodge", alpha = 0.8) + 
  labs(title = "Cause of Death by Gender", x = "Cause of Death", y = "Total Deaths", fill = "Gender") +
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


# Discussion

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.


\newpage


# References


